```json
{
  "preconditions": [
    "The Actor (Maker) possesses 1000 units of the quote token (e.g., USDT).",
    "The Portfolio contract allows the Actor to lock collateral for limit orders.",
    "A second participant (External Caller) is present to provide a matching sell order.",
    "The system is operating in standard matching mode, not Auction Mode."
  ],
  "attack_vector": "Leveraging the logic divergence in TradePairs.matchOrder where collateral is locked at the limitPrice but execution occurs and deducts funds at a lower price without a surplus reconciliation step.",
  "step_by_step": [
    {
      "step": 1,
      "action": "Maker (Actor) submits a Limit Buy Order for 100 units of the base token at a limitPrice of 10 USDT.",
      "expected_result": "Portfolio contract locks 1000 USDT (100 * 10). Maker's Available balance decreases by 1000, and Locked balance increases by 1000."
    },
    {
      "step": 2,
      "action": "External Caller submits a Sell Order for 100 units at a price of 9 USDT, matching the Maker's order.",
      "expected_result": "The TradePairs matching engine selects 9 USDT as the executionPrice."
    },
    {
      "step": 3,
      "action": "The system invokes TradePairs.matchOrder which calls Portfolio.addExecution(makerOrder.id, takerOrder, 9, 100).",
      "expected_result": "Portfolio.addExecution transfers 900 USDT (100 * 9) from the Maker's locked collateral to the External Caller."
    },
    {
      "step": 4,
      "action": "The system marks the Maker's Limit Buy Order as FILLED and removes it from the active order book.",
      "expected_result": "The order is no longer considered open, but no call to portfolio.adjustAvailable is made for the surplus."
    },
    {
      "step": 5,
      "action": "Query the Maker's Portfolio state for Locked and Available balances.",
      "expected_result": "The Portfolio reports 100 USDT (1000 - 900) remains in the Locked balance despite zero open orders."
    }
  ],
  "postconditions": [
    "Maker's OpenOrders set is empty.",
    "Portfolio.locked balance for the Maker is 100 USDT.",
    "Sum of (price * quantity) for Maker's OpenOrders is 0.",
    "State Divergence: Portfolio.locked[Maker] > Î£(OpenOrders[Maker].price * OpenOrders[Maker].quantity).",
    "The 100 USDT surplus is in a state where no system function in standard matching mode can release or unlock it."
  ]
}
```